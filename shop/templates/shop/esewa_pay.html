{% extends "shop/base.html" %}

{% block content %}
<div class="row align-items-center justify-content-center" style="min-height: 60vh;">
    <div class="col-md-5 col-lg-4">
        <div class="card border-0 shadow-lg rounded-3 overflow-hidden">
            <div class="card-header bg-success text-white text-center py-3">
                <h5 class="mb-0 fw-bold"><i class="bi bi-shield-lock-fill me-2"></i>Secure Payment</h5>
            </div>
            <div class="card-body p-4 text-center">
                <div class="mb-4">
                    <p class="text-muted mb-1 text-uppercase small ls-1">Total Amount Payable</p>
                    <h2 class="display-4 fw-bold text-success">NPR {{ total_amount }}</h2>
                </div>

                <div class="alert alert-light border mb-4 d-flex align-items-center" role="alert">
                    <i class="bi bi-info-circle me-3 text-success fs-4"></i>
                    <div class="text-start small text-muted">
                        You will be redirected to eSewa's secure payment gateway to complete your transaction.
                    </div>
                </div>

                <form action="https://rc-epay.esewa.com.np/api/epay/main/v2/form" method="POST">
                    <input type="hidden" name="amount" value="{{ amount }}">
                    <input type="hidden" name="tax_amount" value="{{ tax_amount }}">
                    <input type="hidden" name="total_amount" value="{{ total_amount }}">
                    <input type="hidden" name="transaction_uuid" value="{{ transaction_uuid }}">
                    <input type="hidden" name="product_code" value="{{ product_code }}">
                    <input type="hidden" name="product_service_charge" value="{{ product_service_charge }}">
                    <input type="hidden" name="product_delivery_charge" value="{{ product_delivery_charge }}">
                    <input type="hidden" name="success_url" value="{{ success_url }}">
                    <input type="hidden" name="failure_url" value="{{ failure_url }}">
                    <input type="hidden" name="signed_field_names" value="total_amount,transaction_uuid,product_code">
                    <input type="hidden" name="signature" value="{{ signature }}">

                    <button
                        class="btn btn-success w-100 py-3 fw-bold text-uppercase ls-1 shadow-sm transition-transform">
                        Pay with eSewa <i class="bi bi-arrow-right ms-2"></i>
                    </button>
                    <!-- "Back to Cart" link for better UX -->
                    <a href="{% url 'shop:cart' %}"
                        class="btn btn-link text-muted mt-3 text-decoration-none small">Cancel and Return to Cart</a>
                </form>
            </div>
            <div class="card-footer bg-light text-center py-3 small text-muted">
                <i class="bi bi-lock-fill me-1"></i> 100% Secure Transaction
            </div>
        </div>
    </div>
</div>

<style>
    .ls-1 {
        letter-spacing: 1px;
    }

    .transition-transform:hover {
        transform: translateY(-2px);
    }
</style>
{% endblock %}